\chapterimage{chapter_head_2.pdf}
\chapter{多维随机变量及其分布}

\section{二维随机变量函数$ Z=g(X, Y) $的求解}\index{二维随机变量函数$ Z=g(X, Y) $的求解}



\subsection{分布律求解：（离散型）}\index{二维随机变量函数$ Z=g(X, Y) $的求解!分布律求解：（离散型）}

1、Z的分布律与一维离散型求解类似，列出所有满足$ Z=g(X, Y) $的概率，对相同项进行合并，或一开始就求解等于$ z $的部分，得到$ P\{Z = z\} $的值，即$ Z $的分布律



\subsection{分布函数$ F_Z(z) $求解：（一般类型的X，Y）}\index{二维随机变量函数$ Z=g(X, Y) $的求解!分布函数$ F_Z(z) $求解：（一般类型的X，Y）}

1、公式：$ F_{Z}(z)=P\{Z \leqslant z\}=P\{g(X, Y) \leqslant z\}=\iint_{g(x, y) \leqslant z} f(x, y) \mathrm{d} x \mathrm{~d} y $

注意：通常需要判断$ <font color=purple>z</font> $的范围，保证积分区域不为0



\subsection{连续与离散的组合求解：（$ X $为离散，$ Y $为连续）}\index{二维随机变量函数$ Z=g(X, Y) $的求解!连续与离散的组合求解：（$ X $为离散，$ Y $为连续）}

1、对离散型变量$ X $的各种取值可能用全概率公式展开：$ F_{Z}(z)=P\{Z \leqslant z\}=P\{g(X, Y) \leqslant z\} $ = $ \sum_{i} P\left\{X=x_{i}\right\} P\left\{g(X, Y) \leqslant z \mid X=x_{i}\right\} $ = $ \sum_{i} p_{xi} P\left\{g\left(x_{i}, Y\right) \leqslant z \mid X=x_{i}\right\} $

\section{求解最大最小值的概率}\index{求解最大最小值的概率}



\subsection{$ P\{max(X,Y)\le z\} $，$ Z=max(X,Y) $，求$ F_Z(z) $}\index{求解最大最小值的概率!$ P\{max(X,Y)\le z\} $，$ Z=max(X,Y) $，求$ F_Z(z) $}

1、理解：x和y其中的最大值小于z，所以x和y都应该小于z（因为最大的都不行，所以都不行），即可得到$ F_{Z}(z)=P\{Z\le z\}=P\{max(X,Y)\le z\}=P\{X \le z\}P\{Y \le z\}=F_X(z)F_Y(z) $



\subsection{$ P\{max(X,Y)\ge c\} $}\index{求解最大最小值的概率!$ P\{max(X,Y)\ge c\} $}

1、理解：x和y其中的最大值大于c，但是其中之一可能存在小于c（最大的可以不代表另一个可以），所以转换成求解其反向的范围，转换成了x和y中的最大值小于c，所以x和y都应该小于c，即可得到$ P\{max(X,Y)\ge c\}=1-P\{max(X,Y)\le c\}=1-P\{X \le c\}P\{Y \le c\} $，从直观上来看$ c \rightarrow +\infty $，该式子的概率为0，$ c \rightarrow -\infty $，该式子的概率为1，不可以认为是c的分布函数



\subsection{$ P\{min(X,Y)\le z\} $，$ Z=min(X,Y) $，求$ F_Z(z) $}\index{求解最大最小值的概率!$ P\{min(X,Y)\le z\} $，$ Z=min(X,Y) $，求$ F_Z(z) $}

1、理解：x和y其中的最小值小于z，但是其中之一可能存在大于z（最小的不行不代表另一个不行），所以转换成求解其反向的范围，转换成了x和y中的最小值都大于z，所以x和y都应该大于z，即可得到$ F_{Z}(z)=P\{Z\le z\}=P\{min(X,Y)\le z\}=1-P\{min(X,Y)\ge z\}=1-P\{X \ge z\}P\{Y \ge z\}=1-[1-F_X(z)][1-F_Y(z)] $



\subsection{$ P\{min(X,Y)\ge c\} $}\index{求解最大最小值的概率!$ P\{min(X,Y)\ge c\} $}

1、理解：x和y其中的最小值大于z，所以x和y都应该大于z（因为最小的都行，所以都行），即可得到$ P\{min(X,Y)\ge c\}=P\{X \ge z\}P\{Y \ge z\} $，从直观上来看$ c \rightarrow +\infty $，该式子的概率为0，$ c \rightarrow -\infty $，该式子的概率为1，不可以认为是c的分布函数

注意：需要X,Y互相独立

\section{二维随机变量相关性质}\index{二维随机变量相关性质}



\subsection{分布函数性质：（连续）}\index{二维随机变量相关性质!分布函数性质：（连续）}

1、单调不减、右连续、有界（分布函数均有的性质，无论什么类型）

2、$ F(X,Y) $为二元连续函数（可导性怎么说？）

3、如果$ F(X,Y) $是连续且可导的，则二位随机变量是连续的（连续随机变量的充分条件）



\subsection{概率密度性质：（连续）}\index{二维随机变量相关性质!概率密度性质：（连续）}

1、非负性（是概率密度函数充分条件之一）

2、在$ R^2 $上积分为1（是概率密度函数充分条件之二）

3、改变概率密度个别线上的值，$ f(x,y) $仍是概率密度（个别线上的值不影响积分的值）

4、连续随机变量的概率密度是分布函数对$ xy $的偏导数$ dxdy $（二维上根据分布函数求解概率密度）

5、平面区域的概率等于概率密度在该区域上的积分（二维上求解某个区域的概率）



\subsection{求解概率密度中的未知参数：（连续）}\index{二维随机变量相关性质!求解概率密度中的未知参数：（连续）}

1、利用连续概率密度的性质：二重积分为1；非负

2、利用分布函数的性质：分布函数为连续可导的函数（即分布函数是平滑的）



\subsection{分布函数性质：（离散）}\index{二维随机变量相关性质!分布函数性质：（离散）}

1、单调不减、右连续、有界（分布函数均有的性质，无论什么类型）



\subsection{概率分布性质：（离散）}\index{二维随机变量相关性质!概率分布性质：（离散）}

1、二维随机变量的联合概率分布表示两个随机事件同时发生的概率

2、联合概率分布具有非负性

3、联合概率分布的和为1（验证计算结果的正确性）



\subsection{求解分布律中的未知参数：（离散）}\index{二维随机变量相关性质!求解分布律中的未知参数：（离散）}

1、边缘分布与相应行/列的加减关系

2、分布律中的数值 = 对应行的概率密度 X 对应列的边缘分布（只有在二维变量独立的情况下成立）

3、分布律中对应行的概率成比例（只有在二维变量独立的情况下成立）

\section{求解分布函数（分布律）或概率密度}\index{求解分布函数（分布律）或概率密度}



\subsection{由两个变量的概率密度时求解二维分布函数：（连续、离散）}\index{求解分布函数（分布律）或概率密度!由两个变量的概率密度时求解二维分布函数：（连续、离散）}

1、定义：$ F(x,y)=P\{ X \le x, Y \le y \} $，在概率密度函数中，$ x $和$ y $有关联时，利用绘图确定分布函数的积分范围（将积分变量和积分上下限变量区分开）



\subsection{由两个独立变量的概率密度时求解联合概率密度（分布律）：（连续、离散）}\index{求解分布函数（分布律）或概率密度!由两个独立变量的概率密度时求解联合概率密度（分布律）：（连续、离散）}

1、联合概率密度：$ X,Y $的（边缘）概率密度（分布律）的乘积

注意：独立是前提条件

\section{二维边缘概率密度与边缘分布函数定义与求解}\index{二维边缘概率密度与边缘分布函数定义与求解}



\subsection{定义}\index{二维边缘概率密度与边缘分布函数定义与求解!定义}

1、边缘概率密度公式定义为：关于$ X $的边缘概率密度为将$ Y $方向向$ X $轴收缩（二维概率密度对y进行积分，$ **f_{X}(x)=\int_{-\infty}^{+\infty} f(x, y) \mathrm{d} y** $）；关于$ Y $的边缘概率密度类似

2、边缘分布函数定义为：关于$ X $的边缘分布函数为关于$ **X** $的边缘概率密度在$ **(-\infty,x)** $上的积分（$ F_{X}(x)=F(x,+\infty)=\int_{-\infty}^{x}\left[\int_{-\infty}^{+\infty} f(x, y) \mathrm{d} y\right] \mathrm{d} x $）；关于$ Y $的边缘分布函数类似



\subsection{离散随机变量-求解}\index{二维边缘概率密度与边缘分布函数定义与求解!离散随机变量-求解}

1、求解$ X $的边缘概率密度分布相当于将某个$ X $值对应的所有的$ Y $值得概率相加，得到该$ X $值得边缘概率密度分布；求解$ Y $的边缘概率密度分布类似



\subsection{连续随机变量-求解}\index{二维边缘概率密度与边缘分布函数定义与求解!连续随机变量-求解}

1、求解$ X $的边缘概率密度时对$ Y $进行积分（积分域如果与$ **x** $有关则用$ **x** $表示，否则就是$ **Y** $变量的有效范围）；求解$ Y $的类似

2、如果已知$ X,Y $相互独立，则二维随机变量的概率密度可以分解成$ X $和$ Y $的边缘概率密度相乘的形式（验证边缘概率密度求解的正确性）



\subsection{二维随机变量分布函数求解边缘分布函数：（连续）}\index{二维边缘概率密度与边缘分布函数定义与求解!二维随机变量分布函数求解边缘分布函数：（连续）}

1、求解$ X $的分布函数时将分布函数中$ Y $随机变量设置为无穷大值；求解$ Y $的类似

2、公式：$ F_X(x)=P\{X \le x\} = P\{X \le x,Y<+\infty\} = F(x, +\infty) $；$ F_Y(y) $类似



\subsection{二维随机事件的分布率和边缘分布：（离散）（具体事件）}\index{二维边缘概率密度与边缘分布函数定义与求解!二维随机事件的分布率和边缘分布：（离散）（具体事件）}

1、列出所有的可能性和计算对应的概率（$ P\{X=val_1,Y=val_2\} = p $）

2、列出分布律和边缘分布（第一个变量为竖行，边缘概率密度中代表$ i,p_{i\cdot} $，第二个变量对应为横行，边缘概率密度中代表$ j,p_{\cdot j} $）

3、验证概率和为1（验证求解的正确性）

\section{二维随机变量函数$ Z=X+Y $的求解（连续）}\index{二维随机变量函数$ Z=X+Y $的求解（连续）}



\subsection{一般类型的函数}\index{二维随机变量函数$ Z=X+Y $的求解（连续）!一般类型的函数}

1、公式法：$ F_{Z}(z)=P\{Z \leqslant z\}=P\{X+Y \leqslant z\}=\int_{-\infty}^{+\infty} \mathrm{d} x \int_{-\infty}^{z-x} f(x, y) \mathrm{d} y\left(\text { 或 } \int_{-\infty}^{+\infty} \mathrm{d} y \int_{-\infty}^{z-y} f(x, y) \mathrm{d} x\right) $；由此（这是求导求到里面去了？是的）可得$ Z=X+Y $的概率密度为$ f_{Z}(z)=\int_{-\infty}^{+\infty} f(x, z-x) \mathrm{d} x $（在$ **xOz** $坐标中绘制范围，根据原$ x,y $的范围，求解卷积公式中对应的$ x,z $的范围）或者$ f_{Z}(z)=\int_{-\infty}^{+\infty} f(z-y, y) \mathrm{d} y $（在$ **yOz** $坐标中绘制范围，根据原$ x,y $的范围，求解卷积公式中对应的$ y,z $的范围）

2、卷积公式法：当$ X $和$ Y $相互独立时, $ f(x, y)=f_{X}(x) f_{Y}(y) $, 则$ f_{Z}(z)=\int_{-\infty}^{+\infty} f_{X}(x) f_{Y}(z-x) \mathrm{d} x $或者$ f_{Z}(z)=\int_{-\infty}^{+\infty} f_{X}(z-y) f_{Y}(y) \mathrm{d} y $，这两个公式称为卷积公式,记为$ f_{X} * f_{Y} $

3、定义法：根据函数绘制（在$ **xOy** $坐标中绘制范围）在概率分布中的范围，求解未知变量的分布函数（对于该类型的求解，需要找到$ <font color=purple>g(X, Y) \leqslant z</font> $的范围，并在该范围（范围是关于$ <font color=purple>z</font> $的函数）上积分，即可得到$ <font color=purple>F_{Z}(z)</font> $，对$ <font color=purple>F_{Z}(z)</font> $求导数，即可得到$ <font color=purple>F_{Z}^{'}(z)=f_{Z}(z)</font> $；对于$ <font color=purple>X,Y</font> $概率密度上变量$ <font color=purple>x,y</font> $有关联时，画出概率密度的图像，根据$ <font color=purple>Z=X+Y</font> $求解积分范围，如果是求解概率密度，可以先对变上下限积分求导，再进行积分（技巧））

注：对于$ <font color=purple>X-Y</font> $，$ <font color=purple>min(X,Y)</font> $，$ <font color=purple>max(X,Y)</font> $，$ <font color=purple>X,Y</font> $的初等函数，$ <font color=purple>X,Y</font> $的绝对值的求解也是类似的



\subsection{相互独立的均匀分布：（相互独立的均匀分布的函数组合）}\index{二维随机变量函数$ Z=X+Y $的求解（连续）!相互独立的均匀分布：（相互独立的均匀分布的函数组合）}

1、利用卷积公式，选定区间有限的变量为卷积区间，则$ f_{Z}(z)=\int_{-\infty}^{+\infty} f_{X}(x) f_{Y}(z-x) \mathrm{d} x $（X范围有限）或者$ f_{Z}(z)=\int_{-\infty}^{+\infty} f_{X}(z-y) f_{Y}(y) \mathrm{d} y $（Y范围有限）

注意：需要X,Y互相独立



\subsection{相互独立（不相关）的正态分布：（相互独立的正态分布的组合）}\index{二维随机变量函数$ Z=X+Y $的求解（连续）!相互独立（不相关）的正态分布：（相互独立的正态分布的组合）}

1、相互独立的正态分布具有可加性，$ X \sim{N}\left(\mu_{1}, \sigma_{1}^{2}\right), Y \sim N\left(\mu_{2}, \sigma_{2}^{2}\right) $，$ Z \sim N\left(a\mu_{1}+b\mu_{2}, a^2\sigma_{1}^{2}+b^2\sigma_{2}^{2}\right) $

注意：需要X,Y互相独立

\section{求解与一个离散的随机变量相关的$ X_1 $两个连续的随机变量$ X_2,X_3 $的分布函数}\index{求解与一个离散的随机变量相关的$ X_1 $两个连续的随机变量$ X_2,X_3 $的分布函数}

1、将待求解的两个随机变量的分布函数用定义表示出来$ F(x,y)=P\{ X_2 \le x_2, X_3 \le x_3 \} $，其中$ X_3 $是与$ X_1 $和$ X_2 $相关的函数，由于$ X_1 $是离散的，所以利用离散与连续组合的方法将$ X_3 $在离散变量$ X_1 $上进行全概率展开，求解

注意：求解过程中可能遇到类似$ <font color=purple>P\{ X_1\le x,X_1\le y \} = P\{ X_1 \le min(x,y) \}</font> $二维变量相关的化简情况，特别留意



2 在求解指定$ x $和$ y $的时候时，如果两个随机变量只与其中一个有关（相关性），可以直接代入到定义进行求解$ F(x,y)=P\{ X \le x, Y \le y \} $，转换成求解指定范围的概率（存疑）

\section{常用二维分布}\index{常用二维分布}



\subsection{二维均匀分布}\index{常用二维分布!二维均匀分布}

1、公式：$ f(x, y)=\left\{\begin{array}{lc} \frac{1}{A}, & (x, y) \in G, \\ 0, & \text { 其他 }, \end{array}\right. $其中A是平面有界区域$ G $的面积，则称$ (X,Y) $服从区域$ G $上的均匀分布



\subsection{二维正态分布}\index{常用二维分布!二维正态分布}

公式：$ f(x, y)=\frac{1}{2 \pi \sigma_{1} \sigma_{2} \sqrt{1-\rho^{2}}} \exp \left\{-\frac{1}{2\left(1-\rho^{2}\right)}\left[\frac{\left(x-\mu_{1}\right)^{2}}{\sigma_{1}^{2}}-\frac{2 \rho\left(x-\mu_{1}\right)\left(y-\mu_{2}\right)}{\sigma_{1} \sigma_{2}}+\frac{\left(y-\mu_{2}\right)^{2}}{\sigma_{2}^{2}}\right]\right\}, -\infty<x<+\infty,-\infty<y<+\infty $，其中$ \mu_{1}, \mu_{2}, \sigma_{1}>0, \sigma_{2}>0,-1<\rho<1 $ 均为常数, 则称 $ (X, Y)  $服从参数为$ \mu_{1}, \mu_{2}, \sigma_{1}, \sigma_{2} $和$ \rho $的二维正态分布,记作$ (X, Y) \sim N\left(\mu_{1}, \mu_{2} ; \sigma_{1}^{2}, \sigma_{2}^{2} ; \rho\right) $

性质：

1、$ \left(X, Y\right) \sim N\left(\mu_{1}, \mu_{2} ; \sigma_{1}^{2}, \sigma_{2}^{2} ; \rho\right) $时, $ X $与$ Y $均服从一维正态：$ X \sim{N}\left(\mu_{1}, \sigma_{1}^{2}\right), Y \sim N\left(\mu_{2}, \sigma_{2}^{2}\right) $

2、$ (X, Y) \sim N\left(\mu_{1}, \mu_{2} ; \sigma_{1}^{2}, \sigma_{2}^{2} ; \rho\right) $时, $ X $与$ Y $相互独立的充分必要条件是$ \rho=0 $（正态的独立与不相关是一致的）

3、$ (X, Y) $服从二维正态时,行列式$ \left|\begin{array}{ll}a & b \\ c & d\end{array}\right| \neq 0 $时$ (a X+b Y, c X+d Y) $也服从二维正态（二维正态的满足特定条件（即两个新变量没有常数倍关系，如果有会发生什么）的组合还是二维正态）； $  a X+b Y $服从一维正态$ \left(a^{2}+b^{2} \neq 0\right) $（这是由性质1得出的，需要相互独立条件）

4、约定: 当$ X $与$ Y $均服从一维正态，且相互独立，就是指$ (X, Y) $服从二维正态

5、如果$ X $与$ Y $均服从一维正态, 不能保证$ (X, Y) $服从二维正态, 也不能保证$ a X+b Y $服从一维正态（两个一维正态推不出来组合是一维的，也不能保证能组合出来二维的（需要相互独立的条件））

\section{求解条件概率}\index{求解条件概率}



\subsection{由二维随机概率密度求解条件概率：（连续）}\index{求解条件概率!由二维随机概率密度求解条件概率：（连续）}

1、利用条件概率密度的公式$ P\{X>x|Y>y\} = \frac {P\{X>x,Y>y\}}{P\{Y>y\}} $，利用边缘概率密度和二维概率密度求解

2、画出图形（二维坐标系）辅助理解



\subsection{由二维随机概率密度求解条件概率：（二维均匀分布）}\index{求解条件概率!由二维随机概率密度求解条件概率：（二维均匀分布）}

1、求解二维随机变量的概率密度

2、根据二维变量的概率密度求解边缘概率密度

3、条件概率密度=二维变量的概率密度/对应的边缘概率密度

4、如果是具体值的条件，则可以根据图形进行求解（又快又稳）

注意：标注条件概率密度中的范围（条件概率密度的范围是由对应的边缘概率密度的范围决定的）



\subsection{由二维随机分布律求解条件分布律：（离散）}\index{求解条件概率!由二维随机分布律求解条件分布律：（离散）}

1、利用条件概率密度的公式，利用二维随机变量概率密度和边缘概率密度求解

2、公式：$ P\{X=x|Y=y\} = \frac {P\{X=x,Y=y\}}{P\{Y=y\}} = \frac {p_{ij}}{p_{\cdot j}} $



\section{根据分布律（概率密度）和边缘概率密度运用}\index{根据分布律（概率密度）和边缘概率密度运用}



\subsection{变量独立性判断：（离散）}\index{根据分布律（概率密度）和边缘概率密度运用!变量独立性判断：（离散）}

1、分布律中的数值 等于 对应行的边缘分布值 X 对应列的边缘分布值（即二位分布律等于边缘分布律的乘积） ，则是独立的



\subsection{变量独立性判断：（连续）}\index{根据分布律（概率密度）和边缘概率密度运用!变量独立性判断：（连续）}

1、根据概率分布等于边缘概率密度的乘积，则是独立的

\section{二维随机变量的概率}\index{二维随机变量的概率}



\subsection{连续二维变量的概率：（均匀分布）}\index{二维随机变量的概率!连续二维变量的概率：（均匀分布）}

1、求解整体的区域积分，根据积分为1求解未知参数（如果有未知参数的话）

2、求解指定区域的积分，得到指定区域的概率

3、也可以用积分的比值来求解（面积的比值，因为均匀分布是均匀的），不需要求出具体的概率



\subsection{连续二维变量的组合的概率：（组合形式）}\index{二维随机变量的概率!连续二维变量的组合的概率：（组合形式）}

1、连续二维随机变量概率密度是平面上具有值（然后就成了三维，第三个维度是分布函数在该点的变化率，积分就是概率值）

2、二维随机变量的函数组合就是在二维随机变量的概率密度上求解满足该组合（满足组合起来的指定条件）的区域，然后在该区域上积分



\subsection{连续二维变量的函数组合的概率：（正态分布）（组合形式）}\index{二维随机变量的概率!连续二维变量的函数组合的概率：（正态分布）（组合形式）}

1、方案一：将变量设为极坐标形式转换为角度形式，求解积分（$ (X, Y) \sim N\left(\mu_{1}, \mu_{2} ; \sigma_{1}^{2}, \sigma_{2}^{2} ; 0\right) $对应$ P\{X<Y\}=\iint_{x<y} \frac{1}{2 \pi \sigma^{2}} \mathrm{e}^{-\frac{1}{2 \sigma^{2}}\left[(x-\mu)^{2}+(y-\mu)^{2}\right]} \mathrm{d} x \mathrm{~d} y $，使用极坐标$ \{\begin{array}{l}x-\mu=r \cos \theta, \\ y-\mu=r \sin \theta,\end{array} $代换得到$ P\{X<Y\}=\frac{1}{2 \pi \sigma^{2}} \int_{\frac{\pi}{4}}^{\frac{5}{4} \pi} \mathrm{d} \theta \int_{0}^{+\infty} \mathrm{e}^{-\frac{r^{2}}{2 \sigma^{2}}} r \mathrm{~d} r=\frac{1}{2} $）

2、方案二：将变量转换到一边作为变量组合，求解该变量组合对应的分布（一般需要正态分布的两个随机变量独立，求解变量组合后的$ <font color=purple>\mu</font> $和$ <font color=purple>\sigma^{2}</font> $，合并成一个新的分布）根据该新的分布来求解

注意：方法二求解新的分布计算量小



\section{条件分布律（概率密度）、分布律（概率密度）、边缘分布律（概率密度）：知二求一（离散、连续）}\index{条件分布律（概率密度）、分布律（概率密度）、边缘分布律（概率密度）：知二求一（离散、连续）}

1、求解条件分布律（概率密度）：二维随机变量的分布律（概率密度）除以相应的边缘分布律（概率密度），就是对应的条件分布律（概率密度）

2、求解二位随机变量的分布律（概率密度）：条件分布律（概率密度）乘以对应的边缘分布律（概率密度）（对连续情况特别注意：如果条件概率密度的条件是存在范围的（即条件对应的边缘概率密度的存在范围，条件概率密度离开对应的边缘概率密度的存在也不能存在），一定要验证该范围下求得的分布律是否就已经是全域的分布律了，即对该范围内积分与全域积分对比并且都是1，表明其它范围都是0，从而将求得的局限的分布律（即局限在条件概率密度的条件（对应的边缘概率密度）存在范围）推广到全域上）

3、求解边缘分布律（概率密度）：二位随机变量的分布律（概率密度）除以条件分布律（概率密度）

备注：离散的条件密度（$ <font color=orange>P\{X=x|Y=y\} = \frac {P\{X=x,Y=y\}}{P\{Y=y\}}</font> $）

备注：条件分布定义（$ <font color=orange>F_{X \mid Y}(x \mid y)=\int_{-\infty}^{x} \frac{f(s, y)}{f_{Y}(y)} \mathrm{d} s</font> $）和条件密度定义（$ <font color=orange>f_{X \mid Y}(x \mid y)=\frac{f(x, y)}{f_{Y}(y)}, f_{Y}(y)>0</font> $）

注意：具有范围的相乘时，标注清楚变量的范围（函数定义域），求解完后记得验证

